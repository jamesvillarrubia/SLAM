2018-02-25 14:26:58,842 [INFO] IRT.wrapper: Using IRT.assistments data with problem_id for item_id_col, None for template_id_col, and None for concept_id_col
2018-02-25 14:27:00,064 [INFO] IRT.assistments: Read 525,534 rows from file
2018-02-25 14:27:00,064 [INFO] IRT.assistments: Dataframe index key is order_id
2018-02-25 14:27:00,343 [INFO] IRT.assistments: Removed 178,674 duplicate rows (346,860 rows remaining)
2018-02-25 14:27:00,817 [INFO] IRT.assistments: Removed students with <2 interactions (346,740 rows remaining)
2018-02-25 14:27:00,817 [INFO] IRT.assistments: maxInterNone mininter 2
2018-02-25 14:27:00,969 [INFO] IRT.assistments: concept_id_col not supplied, not using concepts
2018-02-25 14:27:00,969 [INFO] IRT.assistments: template_id_col not supplied, not using templates
2018-02-25 14:27:00,970 [INFO] IRT.assistments: Processed data: 346,740 interactions, 4,097 students; 26,684 items,   0 templates,   0 concepts columns to keep: ['user_idx', 'item_idx', 'correct', 'time_idx']
2018-02-25 14:27:01,007 [INFO] IRT.wrapper: After retaining proportional students, 346,740/346,740 rows and 4,097/4,097 students remain on 26,684 questions, 0.996828
2018-02-25 14:27:01,063 [INFO] IRT.run_mlp: this fold has 69348 interactions and students 3723
2018-02-25 14:27:01,063 [INFO] IRT.run_mlp: Beginning fold 1
2018-02-25 14:27:01,063 [INFO] IRT.run_mlp: Training RNN, fold 1, train length 277392, test length 69348
2018-02-25 14:27:01,063 [INFO] IRT.run_mlp: num_questions=26684? 26684 num_users=4097? 4097
/home/chen/anaconda3/lib/python3.6/site-packages/pandas/core/indexing.py:337: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.obj[key] = _infer_fill_value(value)
/home/chen/anaconda3/lib/python3.6/site-packages/pandas/core/indexing.py:517: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.obj[item] = s
2018-02-25 14:27:01,164 [INFO] IRT.run_mlp: Building model: embedding size 150 hidden dimension 200
2018-02-25 14:27:01,418 [INFO] IRT.run_mlp: NCF input_dim=2*emb_size+1(timestamp) 301 hidden_num 200 output_dim 2
2018-02-25 14:27:01,418 [INFO] IRT.run_mlp: Model optimizer first learning rate is 0.001
2018-02-25 14:27:02,914 [INFO] IRT.run_mlp: Cuda detected, using cuda
2018-02-25 14:27:02,914 [INFO] IRT.run_mlp: Number of iterations for this fold 50
2018-02-25 14:27:02,914 [INFO] IRT.run_mlp: Epoch 0 starts! 
2018-02-25 14:27:07,146 [INFO] IRT.run_mlp: epoch 0 training loss (over all batches) 460.1837 
2018-02-25 14:27:07,147 [INFO] IRT.run_mlp: Epoch 1 starts! 
2018-02-25 14:27:11,303 [INFO] IRT.run_mlp: epoch 1 training loss (over all batches) 395.8968 
2018-02-25 14:27:11,303 [INFO] IRT.run_mlp: Epoch 2 starts! 
2018-02-25 14:27:15,409 [INFO] IRT.run_mlp: epoch 2 training loss (over all batches) 356.4283 
2018-02-25 14:27:15,410 [INFO] IRT.run_mlp: Epoch 3 starts! 
2018-02-25 14:27:19,528 [INFO] IRT.run_mlp: epoch 3 training loss (over all batches) 328.1732 
2018-02-25 14:27:19,529 [INFO] IRT.run_mlp: Epoch 4 starts! 
2018-02-25 14:27:23,633 [INFO] IRT.run_mlp: epoch 4 training loss (over all batches) 297.6064 
2018-02-25 14:27:23,634 [INFO] IRT.run_mlp: Epoch 5 starts! 
2018-02-25 14:27:27,747 [INFO] IRT.run_mlp: epoch 5 training loss (over all batches) 260.5797 
2018-02-25 14:27:27,748 [INFO] IRT.run_mlp: Epoch 6 starts! 
2018-02-25 14:27:31,851 [INFO] IRT.run_mlp: epoch 6 training loss (over all batches) 219.7018 
2018-02-25 14:27:31,852 [INFO] IRT.run_mlp: Epoch 7 starts! 
2018-02-25 14:27:35,985 [INFO] IRT.run_mlp: epoch 7 training loss (over all batches) 180.0376 
2018-02-25 14:27:35,986 [INFO] IRT.run_mlp: Epoch 8 starts! 
2018-02-25 14:27:40,117 [INFO] IRT.run_mlp: epoch 8 training loss (over all batches) 145.4048 
2018-02-25 14:27:40,118 [INFO] IRT.run_mlp: Epoch 9 starts! 
2018-02-25 14:27:44,172 [INFO] IRT.run_mlp: epoch 9 training loss (over all batches) 117.9152 
2018-02-25 14:27:44,173 [INFO] IRT.run_mlp: Epoch 10 starts! 
2018-02-25 14:27:48,299 [INFO] IRT.run_mlp: epoch 10 training loss (over all batches) 97.3956 
2018-02-25 14:27:48,309 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:27:48,317 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7065 auc 0.7429 
2018-02-25 14:27:48,317 [INFO] IRT.run_mlp: Epoch 11 starts! 
2018-02-25 14:27:52,429 [INFO] IRT.run_mlp: epoch 11 training loss (over all batches) 82.1474 
2018-02-25 14:27:52,430 [INFO] IRT.run_mlp: Epoch 12 starts! 
2018-02-25 14:27:56,604 [INFO] IRT.run_mlp: epoch 12 training loss (over all batches) 71.7395 
2018-02-25 14:27:56,605 [INFO] IRT.run_mlp: Epoch 13 starts! 
2018-02-25 14:28:00,784 [INFO] IRT.run_mlp: epoch 13 training loss (over all batches) 64.1781 
2018-02-25 14:28:00,785 [INFO] IRT.run_mlp: Epoch 14 starts! 
2018-02-25 14:28:04,983 [INFO] IRT.run_mlp: epoch 14 training loss (over all batches) 58.5103 
2018-02-25 14:28:04,984 [INFO] IRT.run_mlp: Epoch 15 starts! 
2018-02-25 14:28:09,176 [INFO] IRT.run_mlp: epoch 15 training loss (over all batches) 54.3378 
2018-02-25 14:28:09,177 [INFO] IRT.run_mlp: Epoch 16 starts! 
2018-02-25 14:28:13,338 [INFO] IRT.run_mlp: epoch 16 training loss (over all batches) 51.2670 
2018-02-25 14:28:13,339 [INFO] IRT.run_mlp: Epoch 17 starts! 
2018-02-25 14:28:17,524 [INFO] IRT.run_mlp: epoch 17 training loss (over all batches) 48.2533 
2018-02-25 14:28:17,525 [INFO] IRT.run_mlp: Epoch 18 starts! 
2018-02-25 14:28:21,665 [INFO] IRT.run_mlp: epoch 18 training loss (over all batches) 46.1750 
2018-02-25 14:28:21,666 [INFO] IRT.run_mlp: Epoch 19 starts! 
2018-02-25 14:28:25,835 [INFO] IRT.run_mlp: epoch 19 training loss (over all batches) 45.0889 
2018-02-25 14:28:25,835 [INFO] IRT.run_mlp: Epoch 20 starts! 
2018-02-25 14:28:29,988 [INFO] IRT.run_mlp: epoch 20 training loss (over all batches) 43.6374 
2018-02-25 14:28:29,997 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:28:30,004 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7089 auc 0.7434 
2018-02-25 14:28:30,004 [INFO] IRT.run_mlp: Epoch 21 starts! 
2018-02-25 14:28:34,184 [INFO] IRT.run_mlp: epoch 21 training loss (over all batches) 42.3166 
2018-02-25 14:28:34,185 [INFO] IRT.run_mlp: Epoch 22 starts! 
2018-02-25 14:28:38,355 [INFO] IRT.run_mlp: epoch 22 training loss (over all batches) 41.1804 
2018-02-25 14:28:38,356 [INFO] IRT.run_mlp: Epoch 23 starts! 
2018-02-25 14:28:42,546 [INFO] IRT.run_mlp: epoch 23 training loss (over all batches) 40.5370 
2018-02-25 14:28:42,547 [INFO] IRT.run_mlp: Epoch 24 starts! 
2018-02-25 14:28:46,727 [INFO] IRT.run_mlp: epoch 24 training loss (over all batches) 39.0011 
2018-02-25 14:28:46,728 [INFO] IRT.run_mlp: Epoch 25 starts! 
2018-02-25 14:28:50,875 [INFO] IRT.run_mlp: epoch 25 training loss (over all batches) 38.8040 
2018-02-25 14:28:50,876 [INFO] IRT.run_mlp: Epoch 26 starts! 
2018-02-25 14:28:55,070 [INFO] IRT.run_mlp: epoch 26 training loss (over all batches) 38.0509 
2018-02-25 14:28:55,071 [INFO] IRT.run_mlp: Epoch 27 starts! 
2018-02-25 14:28:59,224 [INFO] IRT.run_mlp: epoch 27 training loss (over all batches) 37.6578 
2018-02-25 14:28:59,225 [INFO] IRT.run_mlp: Epoch 28 starts! 
2018-02-25 14:29:03,401 [INFO] IRT.run_mlp: epoch 28 training loss (over all batches) 37.0179 
2018-02-25 14:29:03,402 [INFO] IRT.run_mlp: Epoch 29 starts! 
2018-02-25 14:29:07,556 [INFO] IRT.run_mlp: epoch 29 training loss (over all batches) 36.8561 
2018-02-25 14:29:07,557 [INFO] IRT.run_mlp: Epoch 30 starts! 
2018-02-25 14:29:11,754 [INFO] IRT.run_mlp: epoch 30 training loss (over all batches) 36.5868 
2018-02-25 14:29:11,763 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:29:11,770 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7119 auc 0.7467 
2018-02-25 14:29:11,770 [INFO] IRT.run_mlp: Epoch 31 starts! 
2018-02-25 14:29:15,949 [INFO] IRT.run_mlp: epoch 31 training loss (over all batches) 36.0374 
2018-02-25 14:29:15,950 [INFO] IRT.run_mlp: Epoch 32 starts! 
2018-02-25 14:29:20,137 [INFO] IRT.run_mlp: epoch 32 training loss (over all batches) 35.7575 
2018-02-25 14:29:20,138 [INFO] IRT.run_mlp: Epoch 33 starts! 
2018-02-25 14:29:24,336 [INFO] IRT.run_mlp: epoch 33 training loss (over all batches) 35.3851 
2018-02-25 14:29:24,337 [INFO] IRT.run_mlp: Epoch 34 starts! 
2018-02-25 14:29:28,474 [INFO] IRT.run_mlp: epoch 34 training loss (over all batches) 35.0595 
2018-02-25 14:29:28,475 [INFO] IRT.run_mlp: Epoch 35 starts! 
2018-02-25 14:29:32,651 [INFO] IRT.run_mlp: epoch 35 training loss (over all batches) 34.9882 
2018-02-25 14:29:32,652 [INFO] IRT.run_mlp: Epoch 36 starts! 
2018-02-25 14:29:36,817 [INFO] IRT.run_mlp: epoch 36 training loss (over all batches) 34.6698 
2018-02-25 14:29:36,818 [INFO] IRT.run_mlp: Epoch 37 starts! 
2018-02-25 14:29:40,996 [INFO] IRT.run_mlp: epoch 37 training loss (over all batches) 34.2839 
2018-02-25 14:29:40,997 [INFO] IRT.run_mlp: Epoch 38 starts! 
2018-02-25 14:29:45,136 [INFO] IRT.run_mlp: epoch 38 training loss (over all batches) 33.9777 
2018-02-25 14:29:45,137 [INFO] IRT.run_mlp: Epoch 39 starts! 
2018-02-25 14:29:49,309 [INFO] IRT.run_mlp: epoch 39 training loss (over all batches) 33.9043 
2018-02-25 14:29:49,310 [INFO] IRT.run_mlp: Epoch 40 starts! 
2018-02-25 14:29:53,458 [INFO] IRT.run_mlp: epoch 40 training loss (over all batches) 33.7079 
2018-02-25 14:29:53,467 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:29:53,474 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7154 auc 0.7409 
2018-02-25 14:29:53,474 [INFO] IRT.run_mlp: Epoch 41 starts! 
2018-02-25 14:29:57,659 [INFO] IRT.run_mlp: epoch 41 training loss (over all batches) 33.9379 
2018-02-25 14:29:57,660 [INFO] IRT.run_mlp: Epoch 42 starts! 
2018-02-25 14:30:01,838 [INFO] IRT.run_mlp: epoch 42 training loss (over all batches) 33.1816 
2018-02-25 14:30:01,839 [INFO] IRT.run_mlp: Epoch 43 starts! 
2018-02-25 14:30:05,980 [INFO] IRT.run_mlp: epoch 43 training loss (over all batches) 33.2744 
2018-02-25 14:30:05,981 [INFO] IRT.run_mlp: Epoch 44 starts! 
2018-02-25 14:30:10,169 [INFO] IRT.run_mlp: epoch 44 training loss (over all batches) 32.9987 
2018-02-25 14:30:10,170 [INFO] IRT.run_mlp: Epoch 45 starts! 
2018-02-25 14:30:14,326 [INFO] IRT.run_mlp: epoch 45 training loss (over all batches) 33.1795 
2018-02-25 14:30:14,327 [INFO] IRT.run_mlp: Epoch 46 starts! 
2018-02-25 14:30:18,514 [INFO] IRT.run_mlp: epoch 46 training loss (over all batches) 32.6266 
2018-02-25 14:30:18,515 [INFO] IRT.run_mlp: Epoch 47 starts! 
2018-02-25 14:30:22,686 [INFO] IRT.run_mlp: epoch 47 training loss (over all batches) 32.8703 
2018-02-25 14:30:22,687 [INFO] IRT.run_mlp: Epoch 48 starts! 
2018-02-25 14:30:26,872 [INFO] IRT.run_mlp: epoch 48 training loss (over all batches) 32.5278 
2018-02-25 14:30:26,872 [INFO] IRT.run_mlp: Epoch 49 starts! 
2018-02-25 14:30:31,058 [INFO] IRT.run_mlp: epoch 49 training loss (over all batches) 32.2139 
2018-02-25 14:30:31,070 [INFO] IRT.run_mlp: Fold 1: Num Interactions: 69348; Test Accuracy: 0.71539; Test AUC: 0.74085
2018-02-25 14:30:31,109 [INFO] IRT.run_mlp: this fold has 69348 interactions and students 3716
2018-02-25 14:30:31,109 [INFO] IRT.run_mlp: Beginning fold 2
2018-02-25 14:30:31,110 [INFO] IRT.run_mlp: Training RNN, fold 2, train length 277392, test length 69348
2018-02-25 14:30:31,110 [INFO] IRT.run_mlp: num_questions=26684? 26684 num_users=4097? 4097
2018-02-25 14:30:31,208 [INFO] IRT.run_mlp: Building model: embedding size 150 hidden dimension 200
2018-02-25 14:30:31,457 [INFO] IRT.run_mlp: NCF input_dim=2*emb_size+1(timestamp) 301 hidden_num 200 output_dim 2
2018-02-25 14:30:31,457 [INFO] IRT.run_mlp: Model optimizer first learning rate is 0.001
2018-02-25 14:30:31,460 [INFO] IRT.run_mlp: Cuda detected, using cuda
2018-02-25 14:30:31,460 [INFO] IRT.run_mlp: Number of iterations for this fold 50
2018-02-25 14:30:31,460 [INFO] IRT.run_mlp: Epoch 0 starts! 
2018-02-25 14:30:35,596 [INFO] IRT.run_mlp: epoch 0 training loss (over all batches) 460.3777 
2018-02-25 14:30:35,597 [INFO] IRT.run_mlp: Epoch 1 starts! 
2018-02-25 14:30:39,807 [INFO] IRT.run_mlp: epoch 1 training loss (over all batches) 394.9615 
2018-02-25 14:30:39,808 [INFO] IRT.run_mlp: Epoch 2 starts! 
2018-02-25 14:30:43,982 [INFO] IRT.run_mlp: epoch 2 training loss (over all batches) 355.5111 
2018-02-25 14:30:43,983 [INFO] IRT.run_mlp: Epoch 3 starts! 
2018-02-25 14:30:48,194 [INFO] IRT.run_mlp: epoch 3 training loss (over all batches) 327.5953 
2018-02-25 14:30:48,195 [INFO] IRT.run_mlp: Epoch 4 starts! 
2018-02-25 14:30:52,377 [INFO] IRT.run_mlp: epoch 4 training loss (over all batches) 296.8541 
2018-02-25 14:30:52,378 [INFO] IRT.run_mlp: Epoch 5 starts! 
2018-02-25 14:30:56,564 [INFO] IRT.run_mlp: epoch 5 training loss (over all batches) 259.7397 
2018-02-25 14:30:56,565 [INFO] IRT.run_mlp: Epoch 6 starts! 
2018-02-25 14:31:00,737 [INFO] IRT.run_mlp: epoch 6 training loss (over all batches) 219.0480 
2018-02-25 14:31:00,738 [INFO] IRT.run_mlp: Epoch 7 starts! 
2018-02-25 14:31:04,937 [INFO] IRT.run_mlp: epoch 7 training loss (over all batches) 179.1191 
2018-02-25 14:31:04,938 [INFO] IRT.run_mlp: Epoch 8 starts! 
2018-02-25 14:31:09,128 [INFO] IRT.run_mlp: epoch 8 training loss (over all batches) 145.7019 
2018-02-25 14:31:09,129 [INFO] IRT.run_mlp: Epoch 9 starts! 
2018-02-25 14:31:13,289 [INFO] IRT.run_mlp: epoch 9 training loss (over all batches) 117.6827 
2018-02-25 14:31:13,290 [INFO] IRT.run_mlp: Epoch 10 starts! 
2018-02-25 14:31:17,440 [INFO] IRT.run_mlp: epoch 10 training loss (over all batches) 97.6682 
2018-02-25 14:31:17,449 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:31:17,457 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7010 auc 0.7367 
2018-02-25 14:31:17,457 [INFO] IRT.run_mlp: Epoch 11 starts! 
2018-02-25 14:31:21,552 [INFO] IRT.run_mlp: epoch 11 training loss (over all batches) 82.8778 
2018-02-25 14:31:21,553 [INFO] IRT.run_mlp: Epoch 12 starts! 
2018-02-25 14:31:25,711 [INFO] IRT.run_mlp: epoch 12 training loss (over all batches) 71.8332 
2018-02-25 14:31:25,712 [INFO] IRT.run_mlp: Epoch 13 starts! 
2018-02-25 14:31:29,823 [INFO] IRT.run_mlp: epoch 13 training loss (over all batches) 64.8862 
2018-02-25 14:31:29,824 [INFO] IRT.run_mlp: Epoch 14 starts! 
2018-02-25 14:31:34,002 [INFO] IRT.run_mlp: epoch 14 training loss (over all batches) 59.4513 
2018-02-25 14:31:34,003 [INFO] IRT.run_mlp: Epoch 15 starts! 
2018-02-25 14:31:38,136 [INFO] IRT.run_mlp: epoch 15 training loss (over all batches) 55.6055 
2018-02-25 14:31:38,137 [INFO] IRT.run_mlp: Epoch 16 starts! 
2018-02-25 14:31:42,292 [INFO] IRT.run_mlp: epoch 16 training loss (over all batches) 52.3724 
2018-02-25 14:31:42,293 [INFO] IRT.run_mlp: Epoch 17 starts! 
2018-02-25 14:31:46,443 [INFO] IRT.run_mlp: epoch 17 training loss (over all batches) 49.1047 
2018-02-25 14:31:46,444 [INFO] IRT.run_mlp: Epoch 18 starts! 
2018-02-25 14:31:50,577 [INFO] IRT.run_mlp: epoch 18 training loss (over all batches) 47.6662 
2018-02-25 14:31:50,578 [INFO] IRT.run_mlp: Epoch 19 starts! 
2018-02-25 14:31:54,769 [INFO] IRT.run_mlp: epoch 19 training loss (over all batches) 45.8472 
2018-02-25 14:31:54,770 [INFO] IRT.run_mlp: Epoch 20 starts! 
2018-02-25 14:31:58,941 [INFO] IRT.run_mlp: epoch 20 training loss (over all batches) 44.7848 
2018-02-25 14:31:58,950 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:31:58,958 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7069 auc 0.7406 
2018-02-25 14:31:58,958 [INFO] IRT.run_mlp: Epoch 21 starts! 
2018-02-25 14:32:03,146 [INFO] IRT.run_mlp: epoch 21 training loss (over all batches) 43.3058 
2018-02-25 14:32:03,147 [INFO] IRT.run_mlp: Epoch 22 starts! 
2018-02-25 14:32:07,297 [INFO] IRT.run_mlp: epoch 22 training loss (over all batches) 42.9699 
2018-02-25 14:32:07,298 [INFO] IRT.run_mlp: Epoch 23 starts! 
2018-02-25 14:32:11,468 [INFO] IRT.run_mlp: epoch 23 training loss (over all batches) 41.3963 
2018-02-25 14:32:11,469 [INFO] IRT.run_mlp: Epoch 24 starts! 
2018-02-25 14:32:15,658 [INFO] IRT.run_mlp: epoch 24 training loss (over all batches) 41.4124 
2018-02-25 14:32:15,659 [INFO] IRT.run_mlp: Epoch 25 starts! 
2018-02-25 14:32:19,820 [INFO] IRT.run_mlp: epoch 25 training loss (over all batches) 40.1142 
2018-02-25 14:32:19,821 [INFO] IRT.run_mlp: Epoch 26 starts! 
2018-02-25 14:32:23,997 [INFO] IRT.run_mlp: epoch 26 training loss (over all batches) 39.5845 
2018-02-25 14:32:23,998 [INFO] IRT.run_mlp: Epoch 27 starts! 
2018-02-25 14:32:28,135 [INFO] IRT.run_mlp: epoch 27 training loss (over all batches) 38.9217 
2018-02-25 14:32:28,136 [INFO] IRT.run_mlp: Epoch 28 starts! 
2018-02-25 14:32:32,315 [INFO] IRT.run_mlp: epoch 28 training loss (over all batches) 38.2797 
2018-02-25 14:32:32,316 [INFO] IRT.run_mlp: Epoch 29 starts! 
2018-02-25 14:32:36,429 [INFO] IRT.run_mlp: epoch 29 training loss (over all batches) 38.3558 
2018-02-25 14:32:36,429 [INFO] IRT.run_mlp: Epoch 30 starts! 
2018-02-25 14:32:40,624 [INFO] IRT.run_mlp: epoch 30 training loss (over all batches) 37.4541 
2018-02-25 14:32:40,633 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:32:40,640 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7130 auc 0.7430 
2018-02-25 14:32:40,640 [INFO] IRT.run_mlp: Epoch 31 starts! 
2018-02-25 14:32:44,714 [INFO] IRT.run_mlp: epoch 31 training loss (over all batches) 37.0485 
2018-02-25 14:32:44,715 [INFO] IRT.run_mlp: Epoch 32 starts! 
2018-02-25 14:32:48,867 [INFO] IRT.run_mlp: epoch 32 training loss (over all batches) 36.8359 
2018-02-25 14:32:48,868 [INFO] IRT.run_mlp: Epoch 33 starts! 
2018-02-25 14:32:53,058 [INFO] IRT.run_mlp: epoch 33 training loss (over all batches) 36.3642 
2018-02-25 14:32:53,059 [INFO] IRT.run_mlp: Epoch 34 starts! 
2018-02-25 14:32:57,206 [INFO] IRT.run_mlp: epoch 34 training loss (over all batches) 36.3119 
2018-02-25 14:32:57,207 [INFO] IRT.run_mlp: Epoch 35 starts! 
2018-02-25 14:33:01,382 [INFO] IRT.run_mlp: epoch 35 training loss (over all batches) 36.3108 
2018-02-25 14:33:01,383 [INFO] IRT.run_mlp: Epoch 36 starts! 
2018-02-25 14:33:05,567 [INFO] IRT.run_mlp: epoch 36 training loss (over all batches) 35.4499 
2018-02-25 14:33:05,568 [INFO] IRT.run_mlp: Epoch 37 starts! 
2018-02-25 14:33:09,781 [INFO] IRT.run_mlp: epoch 37 training loss (over all batches) 35.0715 
2018-02-25 14:33:09,782 [INFO] IRT.run_mlp: Epoch 38 starts! 
2018-02-25 14:33:13,953 [INFO] IRT.run_mlp: epoch 38 training loss (over all batches) 35.2707 
2018-02-25 14:33:13,954 [INFO] IRT.run_mlp: Epoch 39 starts! 
2018-02-25 14:33:18,142 [INFO] IRT.run_mlp: epoch 39 training loss (over all batches) 34.8817 
2018-02-25 14:33:18,143 [INFO] IRT.run_mlp: Epoch 40 starts! 
2018-02-25 14:33:22,340 [INFO] IRT.run_mlp: epoch 40 training loss (over all batches) 34.6644 
2018-02-25 14:33:22,349 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:33:22,356 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7132 auc 0.7422 
2018-02-25 14:33:22,356 [INFO] IRT.run_mlp: Epoch 41 starts! 
2018-02-25 14:33:26,518 [INFO] IRT.run_mlp: epoch 41 training loss (over all batches) 34.6849 
2018-02-25 14:33:26,519 [INFO] IRT.run_mlp: Epoch 42 starts! 
2018-02-25 14:33:30,698 [INFO] IRT.run_mlp: epoch 42 training loss (over all batches) 34.4061 
2018-02-25 14:33:30,699 [INFO] IRT.run_mlp: Epoch 43 starts! 
2018-02-25 14:33:34,860 [INFO] IRT.run_mlp: epoch 43 training loss (over all batches) 34.2358 
2018-02-25 14:33:34,861 [INFO] IRT.run_mlp: Epoch 44 starts! 
2018-02-25 14:33:39,025 [INFO] IRT.run_mlp: epoch 44 training loss (over all batches) 33.7667 
2018-02-25 14:33:39,026 [INFO] IRT.run_mlp: Epoch 45 starts! 
2018-02-25 14:33:43,175 [INFO] IRT.run_mlp: epoch 45 training loss (over all batches) 33.9034 
2018-02-25 14:33:43,176 [INFO] IRT.run_mlp: Epoch 46 starts! 
2018-02-25 14:33:47,363 [INFO] IRT.run_mlp: epoch 46 training loss (over all batches) 33.3029 
2018-02-25 14:33:47,364 [INFO] IRT.run_mlp: Epoch 47 starts! 
2018-02-25 14:33:51,519 [INFO] IRT.run_mlp: epoch 47 training loss (over all batches) 33.4579 
2018-02-25 14:33:51,520 [INFO] IRT.run_mlp: Epoch 48 starts! 
2018-02-25 14:33:55,708 [INFO] IRT.run_mlp: epoch 48 training loss (over all batches) 33.3215 
2018-02-25 14:33:55,709 [INFO] IRT.run_mlp: Epoch 49 starts! 
2018-02-25 14:33:59,892 [INFO] IRT.run_mlp: epoch 49 training loss (over all batches) 33.5836 
2018-02-25 14:33:59,904 [INFO] IRT.run_mlp: Fold 2: Num Interactions: 69348; Test Accuracy: 0.71321; Test AUC: 0.74225
2018-02-25 14:33:59,945 [INFO] IRT.run_mlp: this fold has 69348 interactions and students 3730
2018-02-25 14:33:59,945 [INFO] IRT.run_mlp: Beginning fold 3
2018-02-25 14:33:59,945 [INFO] IRT.run_mlp: Training RNN, fold 3, train length 277392, test length 69348
2018-02-25 14:33:59,945 [INFO] IRT.run_mlp: num_questions=26684? 26684 num_users=4097? 4097
2018-02-25 14:34:00,049 [INFO] IRT.run_mlp: Building model: embedding size 150 hidden dimension 200
2018-02-25 14:34:00,299 [INFO] IRT.run_mlp: NCF input_dim=2*emb_size+1(timestamp) 301 hidden_num 200 output_dim 2
2018-02-25 14:34:00,300 [INFO] IRT.run_mlp: Model optimizer first learning rate is 0.001
2018-02-25 14:34:00,303 [INFO] IRT.run_mlp: Cuda detected, using cuda
2018-02-25 14:34:00,303 [INFO] IRT.run_mlp: Number of iterations for this fold 50
2018-02-25 14:34:00,303 [INFO] IRT.run_mlp: Epoch 0 starts! 
2018-02-25 14:34:04,455 [INFO] IRT.run_mlp: epoch 0 training loss (over all batches) 459.6200 
2018-02-25 14:34:04,456 [INFO] IRT.run_mlp: Epoch 1 starts! 
2018-02-25 14:34:08,634 [INFO] IRT.run_mlp: epoch 1 training loss (over all batches) 395.5363 
2018-02-25 14:34:08,635 [INFO] IRT.run_mlp: Epoch 2 starts! 
2018-02-25 14:34:12,789 [INFO] IRT.run_mlp: epoch 2 training loss (over all batches) 355.9169 
2018-02-25 14:34:12,790 [INFO] IRT.run_mlp: Epoch 3 starts! 
2018-02-25 14:34:16,963 [INFO] IRT.run_mlp: epoch 3 training loss (over all batches) 326.5442 
2018-02-25 14:34:16,964 [INFO] IRT.run_mlp: Epoch 4 starts! 
2018-02-25 14:34:21,109 [INFO] IRT.run_mlp: epoch 4 training loss (over all batches) 295.1975 
2018-02-25 14:34:21,110 [INFO] IRT.run_mlp: Epoch 5 starts! 
2018-02-25 14:34:25,279 [INFO] IRT.run_mlp: epoch 5 training loss (over all batches) 257.0613 
2018-02-25 14:34:25,280 [INFO] IRT.run_mlp: Epoch 6 starts! 
2018-02-25 14:34:29,430 [INFO] IRT.run_mlp: epoch 6 training loss (over all batches) 216.2760 
2018-02-25 14:34:29,431 [INFO] IRT.run_mlp: Epoch 7 starts! 
2018-02-25 14:34:33,573 [INFO] IRT.run_mlp: epoch 7 training loss (over all batches) 177.4444 
2018-02-25 14:34:33,574 [INFO] IRT.run_mlp: Epoch 8 starts! 
2018-02-25 14:34:37,739 [INFO] IRT.run_mlp: epoch 8 training loss (over all batches) 143.8506 
2018-02-25 14:34:37,740 [INFO] IRT.run_mlp: Epoch 9 starts! 
2018-02-25 14:34:41,901 [INFO] IRT.run_mlp: epoch 9 training loss (over all batches) 117.3651 
2018-02-25 14:34:41,902 [INFO] IRT.run_mlp: Epoch 10 starts! 
2018-02-25 14:34:46,069 [INFO] IRT.run_mlp: epoch 10 training loss (over all batches) 96.6567 
2018-02-25 14:34:46,078 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:34:46,086 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7031 auc 0.7428 
2018-02-25 14:34:46,087 [INFO] IRT.run_mlp: Epoch 11 starts! 
2018-02-25 14:34:50,217 [INFO] IRT.run_mlp: epoch 11 training loss (over all batches) 82.4644 
2018-02-25 14:34:50,218 [INFO] IRT.run_mlp: Epoch 12 starts! 
2018-02-25 14:34:54,369 [INFO] IRT.run_mlp: epoch 12 training loss (over all batches) 72.5457 
2018-02-25 14:34:54,370 [INFO] IRT.run_mlp: Epoch 13 starts! 
2018-02-25 14:34:58,532 [INFO] IRT.run_mlp: epoch 13 training loss (over all batches) 65.3204 
2018-02-25 14:34:58,533 [INFO] IRT.run_mlp: Epoch 14 starts! 
2018-02-25 14:35:02,715 [INFO] IRT.run_mlp: epoch 14 training loss (over all batches) 59.5604 
2018-02-25 14:35:02,716 [INFO] IRT.run_mlp: Epoch 15 starts! 
2018-02-25 14:35:06,867 [INFO] IRT.run_mlp: epoch 15 training loss (over all batches) 55.4206 
2018-02-25 14:35:06,868 [INFO] IRT.run_mlp: Epoch 16 starts! 
2018-02-25 14:35:11,031 [INFO] IRT.run_mlp: epoch 16 training loss (over all batches) 52.0257 
2018-02-25 14:35:11,032 [INFO] IRT.run_mlp: Epoch 17 starts! 
2018-02-25 14:35:15,237 [INFO] IRT.run_mlp: epoch 17 training loss (over all batches) 50.1104 
2018-02-25 14:35:15,238 [INFO] IRT.run_mlp: Epoch 18 starts! 
2018-02-25 14:35:19,410 [INFO] IRT.run_mlp: epoch 18 training loss (over all batches) 48.0642 
2018-02-25 14:35:19,411 [INFO] IRT.run_mlp: Epoch 19 starts! 
2018-02-25 14:35:23,614 [INFO] IRT.run_mlp: epoch 19 training loss (over all batches) 46.6602 
2018-02-25 14:35:23,615 [INFO] IRT.run_mlp: Epoch 20 starts! 
2018-02-25 14:35:27,784 [INFO] IRT.run_mlp: epoch 20 training loss (over all batches) 44.4479 
2018-02-25 14:35:27,794 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:35:27,801 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7065 auc 0.7457 
2018-02-25 14:35:27,801 [INFO] IRT.run_mlp: Epoch 21 starts! 
2018-02-25 14:35:32,002 [INFO] IRT.run_mlp: epoch 21 training loss (over all batches) 43.9626 
2018-02-25 14:35:32,003 [INFO] IRT.run_mlp: Epoch 22 starts! 
2018-02-25 14:35:36,177 [INFO] IRT.run_mlp: epoch 22 training loss (over all batches) 42.2931 
2018-02-25 14:35:36,178 [INFO] IRT.run_mlp: Epoch 23 starts! 
2018-02-25 14:35:40,377 [INFO] IRT.run_mlp: epoch 23 training loss (over all batches) 41.3509 
2018-02-25 14:35:40,378 [INFO] IRT.run_mlp: Epoch 24 starts! 
2018-02-25 14:35:44,584 [INFO] IRT.run_mlp: epoch 24 training loss (over all batches) 40.8588 
2018-02-25 14:35:44,585 [INFO] IRT.run_mlp: Epoch 25 starts! 
2018-02-25 14:35:48,754 [INFO] IRT.run_mlp: epoch 25 training loss (over all batches) 40.3346 
2018-02-25 14:35:48,755 [INFO] IRT.run_mlp: Epoch 26 starts! 
2018-02-25 14:35:52,958 [INFO] IRT.run_mlp: epoch 26 training loss (over all batches) 39.6844 
2018-02-25 14:35:52,959 [INFO] IRT.run_mlp: Epoch 27 starts! 
2018-02-25 14:35:57,142 [INFO] IRT.run_mlp: epoch 27 training loss (over all batches) 38.9574 
2018-02-25 14:35:57,143 [INFO] IRT.run_mlp: Epoch 28 starts! 
2018-02-25 14:36:01,342 [INFO] IRT.run_mlp: epoch 28 training loss (over all batches) 38.6442 
2018-02-25 14:36:01,343 [INFO] IRT.run_mlp: Epoch 29 starts! 
2018-02-25 14:36:05,483 [INFO] IRT.run_mlp: epoch 29 training loss (over all batches) 38.1610 
2018-02-25 14:36:05,484 [INFO] IRT.run_mlp: Epoch 30 starts! 
2018-02-25 14:36:09,667 [INFO] IRT.run_mlp: epoch 30 training loss (over all batches) 37.6951 
2018-02-25 14:36:09,676 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:36:09,683 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7144 auc 0.7465 
2018-02-25 14:36:09,683 [INFO] IRT.run_mlp: Epoch 31 starts! 
2018-02-25 14:36:13,847 [INFO] IRT.run_mlp: epoch 31 training loss (over all batches) 37.3846 
2018-02-25 14:36:13,848 [INFO] IRT.run_mlp: Epoch 32 starts! 
2018-02-25 14:36:18,050 [INFO] IRT.run_mlp: epoch 32 training loss (over all batches) 36.8265 
2018-02-25 14:36:18,051 [INFO] IRT.run_mlp: Epoch 33 starts! 
2018-02-25 14:36:22,247 [INFO] IRT.run_mlp: epoch 33 training loss (over all batches) 36.7517 
2018-02-25 14:36:22,248 [INFO] IRT.run_mlp: Epoch 34 starts! 
2018-02-25 14:36:26,412 [INFO] IRT.run_mlp: epoch 34 training loss (over all batches) 36.2365 
2018-02-25 14:36:26,413 [INFO] IRT.run_mlp: Epoch 35 starts! 
2018-02-25 14:36:30,590 [INFO] IRT.run_mlp: epoch 35 training loss (over all batches) 36.2542 
2018-02-25 14:36:30,591 [INFO] IRT.run_mlp: Epoch 36 starts! 
2018-02-25 14:36:34,743 [INFO] IRT.run_mlp: epoch 36 training loss (over all batches) 35.7518 
2018-02-25 14:36:34,744 [INFO] IRT.run_mlp: Epoch 37 starts! 
2018-02-25 14:36:38,925 [INFO] IRT.run_mlp: epoch 37 training loss (over all batches) 35.4733 
2018-02-25 14:36:38,926 [INFO] IRT.run_mlp: Epoch 38 starts! 
2018-02-25 14:36:43,077 [INFO] IRT.run_mlp: epoch 38 training loss (over all batches) 35.0968 
2018-02-25 14:36:43,078 [INFO] IRT.run_mlp: Epoch 39 starts! 
2018-02-25 14:36:47,256 [INFO] IRT.run_mlp: epoch 39 training loss (over all batches) 34.8635 
2018-02-25 14:36:47,257 [INFO] IRT.run_mlp: Epoch 40 starts! 
2018-02-25 14:36:51,409 [INFO] IRT.run_mlp: epoch 40 training loss (over all batches) 35.5790 
2018-02-25 14:36:51,418 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:36:51,425 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7213 auc 0.7485 
2018-02-25 14:36:51,425 [INFO] IRT.run_mlp: Epoch 41 starts! 
2018-02-25 14:36:55,587 [INFO] IRT.run_mlp: epoch 41 training loss (over all batches) 34.4713 
2018-02-25 14:36:55,588 [INFO] IRT.run_mlp: Epoch 42 starts! 
2018-02-25 14:36:59,768 [INFO] IRT.run_mlp: epoch 42 training loss (over all batches) 34.7805 
2018-02-25 14:36:59,769 [INFO] IRT.run_mlp: Epoch 43 starts! 
2018-02-25 14:37:03,894 [INFO] IRT.run_mlp: epoch 43 training loss (over all batches) 34.4057 
2018-02-25 14:37:03,895 [INFO] IRT.run_mlp: Epoch 44 starts! 
2018-02-25 14:37:08,041 [INFO] IRT.run_mlp: epoch 44 training loss (over all batches) 34.6694 
2018-02-25 14:37:08,042 [INFO] IRT.run_mlp: Epoch 45 starts! 
2018-02-25 14:37:12,147 [INFO] IRT.run_mlp: epoch 45 training loss (over all batches) 34.2015 
2018-02-25 14:37:12,148 [INFO] IRT.run_mlp: Epoch 46 starts! 
2018-02-25 14:37:16,329 [INFO] IRT.run_mlp: epoch 46 training loss (over all batches) 33.5451 
2018-02-25 14:37:16,330 [INFO] IRT.run_mlp: Epoch 47 starts! 
2018-02-25 14:37:20,494 [INFO] IRT.run_mlp: epoch 47 training loss (over all batches) 33.8435 
2018-02-25 14:37:20,495 [INFO] IRT.run_mlp: Epoch 48 starts! 
2018-02-25 14:37:24,700 [INFO] IRT.run_mlp: epoch 48 training loss (over all batches) 33.9365 
2018-02-25 14:37:24,701 [INFO] IRT.run_mlp: Epoch 49 starts! 
2018-02-25 14:37:28,893 [INFO] IRT.run_mlp: epoch 49 training loss (over all batches) 33.5970 
2018-02-25 14:37:28,905 [INFO] IRT.run_mlp: Fold 3: Num Interactions: 69348; Test Accuracy: 0.72132; Test AUC: 0.74853
2018-02-25 14:37:28,944 [INFO] IRT.run_mlp: this fold has 69348 interactions and students 3732
2018-02-25 14:37:28,945 [INFO] IRT.run_mlp: Beginning fold 4
2018-02-25 14:37:28,945 [INFO] IRT.run_mlp: Training RNN, fold 4, train length 277392, test length 69348
2018-02-25 14:37:28,945 [INFO] IRT.run_mlp: num_questions=26684? 26684 num_users=4097? 4097
2018-02-25 14:37:29,043 [INFO] IRT.run_mlp: Building model: embedding size 150 hidden dimension 200
2018-02-25 14:37:29,292 [INFO] IRT.run_mlp: NCF input_dim=2*emb_size+1(timestamp) 301 hidden_num 200 output_dim 2
2018-02-25 14:37:29,292 [INFO] IRT.run_mlp: Model optimizer first learning rate is 0.001
2018-02-25 14:37:29,296 [INFO] IRT.run_mlp: Cuda detected, using cuda
2018-02-25 14:37:29,296 [INFO] IRT.run_mlp: Number of iterations for this fold 50
2018-02-25 14:37:29,296 [INFO] IRT.run_mlp: Epoch 0 starts! 
2018-02-25 14:37:33,435 [INFO] IRT.run_mlp: epoch 0 training loss (over all batches) 460.3223 
2018-02-25 14:37:33,436 [INFO] IRT.run_mlp: Epoch 1 starts! 
2018-02-25 14:37:37,608 [INFO] IRT.run_mlp: epoch 1 training loss (over all batches) 395.7374 
2018-02-25 14:37:37,609 [INFO] IRT.run_mlp: Epoch 2 starts! 
2018-02-25 14:37:41,756 [INFO] IRT.run_mlp: epoch 2 training loss (over all batches) 356.2086 
2018-02-25 14:37:41,757 [INFO] IRT.run_mlp: Epoch 3 starts! 
2018-02-25 14:37:45,939 [INFO] IRT.run_mlp: epoch 3 training loss (over all batches) 328.0121 
2018-02-25 14:37:45,940 [INFO] IRT.run_mlp: Epoch 4 starts! 
2018-02-25 14:37:50,088 [INFO] IRT.run_mlp: epoch 4 training loss (over all batches) 297.4991 
2018-02-25 14:37:50,088 [INFO] IRT.run_mlp: Epoch 5 starts! 
2018-02-25 14:37:54,255 [INFO] IRT.run_mlp: epoch 5 training loss (over all batches) 260.7044 
2018-02-25 14:37:54,256 [INFO] IRT.run_mlp: Epoch 6 starts! 
2018-02-25 14:37:58,400 [INFO] IRT.run_mlp: epoch 6 training loss (over all batches) 219.9366 
2018-02-25 14:37:58,400 [INFO] IRT.run_mlp: Epoch 7 starts! 
2018-02-25 14:38:02,574 [INFO] IRT.run_mlp: epoch 7 training loss (over all batches) 180.7593 
2018-02-25 14:38:02,575 [INFO] IRT.run_mlp: Epoch 8 starts! 
2018-02-25 14:38:06,748 [INFO] IRT.run_mlp: epoch 8 training loss (over all batches) 146.4730 
2018-02-25 14:38:06,749 [INFO] IRT.run_mlp: Epoch 9 starts! 
2018-02-25 14:38:10,912 [INFO] IRT.run_mlp: epoch 9 training loss (over all batches) 119.0845 
2018-02-25 14:38:10,913 [INFO] IRT.run_mlp: Epoch 10 starts! 
2018-02-25 14:38:15,113 [INFO] IRT.run_mlp: epoch 10 training loss (over all batches) 98.7381 
2018-02-25 14:38:15,122 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:38:15,130 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7014 auc 0.7399 
2018-02-25 14:38:15,130 [INFO] IRT.run_mlp: Epoch 11 starts! 
2018-02-25 14:38:19,311 [INFO] IRT.run_mlp: epoch 11 training loss (over all batches) 84.5086 
2018-02-25 14:38:19,312 [INFO] IRT.run_mlp: Epoch 12 starts! 
2018-02-25 14:38:23,514 [INFO] IRT.run_mlp: epoch 12 training loss (over all batches) 74.1198 
2018-02-25 14:38:23,515 [INFO] IRT.run_mlp: Epoch 13 starts! 
2018-02-25 14:38:27,686 [INFO] IRT.run_mlp: epoch 13 training loss (over all batches) 65.5331 
2018-02-25 14:38:27,687 [INFO] IRT.run_mlp: Epoch 14 starts! 
2018-02-25 14:38:31,872 [INFO] IRT.run_mlp: epoch 14 training loss (over all batches) 59.9742 
2018-02-25 14:38:31,873 [INFO] IRT.run_mlp: Epoch 15 starts! 
2018-02-25 14:38:36,016 [INFO] IRT.run_mlp: epoch 15 training loss (over all batches) 55.9581 
2018-02-25 14:38:36,017 [INFO] IRT.run_mlp: Epoch 16 starts! 
2018-02-25 14:38:40,178 [INFO] IRT.run_mlp: epoch 16 training loss (over all batches) 52.8303 
2018-02-25 14:38:40,179 [INFO] IRT.run_mlp: Epoch 17 starts! 
2018-02-25 14:38:44,358 [INFO] IRT.run_mlp: epoch 17 training loss (over all batches) 50.1932 
2018-02-25 14:38:44,359 [INFO] IRT.run_mlp: Epoch 18 starts! 
2018-02-25 14:38:48,521 [INFO] IRT.run_mlp: epoch 18 training loss (over all batches) 48.0903 
2018-02-25 14:38:48,522 [INFO] IRT.run_mlp: Epoch 19 starts! 
2018-02-25 14:38:52,707 [INFO] IRT.run_mlp: epoch 19 training loss (over all batches) 46.5380 
2018-02-25 14:38:52,708 [INFO] IRT.run_mlp: Epoch 20 starts! 
2018-02-25 14:38:56,865 [INFO] IRT.run_mlp: epoch 20 training loss (over all batches) 45.0806 
2018-02-25 14:38:56,874 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:38:56,881 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7085 auc 0.7428 
2018-02-25 14:38:56,881 [INFO] IRT.run_mlp: Epoch 21 starts! 
2018-02-25 14:39:01,056 [INFO] IRT.run_mlp: epoch 21 training loss (over all batches) 43.7280 
2018-02-25 14:39:01,057 [INFO] IRT.run_mlp: Epoch 22 starts! 
2018-02-25 14:39:05,207 [INFO] IRT.run_mlp: epoch 22 training loss (over all batches) 42.7390 
2018-02-25 14:39:05,208 [INFO] IRT.run_mlp: Epoch 23 starts! 
2018-02-25 14:39:09,367 [INFO] IRT.run_mlp: epoch 23 training loss (over all batches) 41.8704 
2018-02-25 14:39:09,368 [INFO] IRT.run_mlp: Epoch 24 starts! 
2018-02-25 14:39:13,510 [INFO] IRT.run_mlp: epoch 24 training loss (over all batches) 40.7732 
2018-02-25 14:39:13,510 [INFO] IRT.run_mlp: Epoch 25 starts! 
2018-02-25 14:39:17,661 [INFO] IRT.run_mlp: epoch 25 training loss (over all batches) 40.3393 
2018-02-25 14:39:17,661 [INFO] IRT.run_mlp: Epoch 26 starts! 
2018-02-25 14:39:21,806 [INFO] IRT.run_mlp: epoch 26 training loss (over all batches) 39.3775 
2018-02-25 14:39:21,807 [INFO] IRT.run_mlp: Epoch 27 starts! 
2018-02-25 14:39:25,925 [INFO] IRT.run_mlp: epoch 27 training loss (over all batches) 39.3537 
2018-02-25 14:39:25,926 [INFO] IRT.run_mlp: Epoch 28 starts! 
2018-02-25 14:39:30,068 [INFO] IRT.run_mlp: epoch 28 training loss (over all batches) 38.8975 
2018-02-25 14:39:30,069 [INFO] IRT.run_mlp: Epoch 29 starts! 
2018-02-25 14:39:34,212 [INFO] IRT.run_mlp: epoch 29 training loss (over all batches) 38.2321 
2018-02-25 14:39:34,213 [INFO] IRT.run_mlp: Epoch 30 starts! 
2018-02-25 14:39:38,374 [INFO] IRT.run_mlp: epoch 30 training loss (over all batches) 37.8462 
2018-02-25 14:39:38,383 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:39:38,390 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7095 auc 0.7408 
2018-02-25 14:39:38,390 [INFO] IRT.run_mlp: Epoch 31 starts! 
2018-02-25 14:39:42,553 [INFO] IRT.run_mlp: epoch 31 training loss (over all batches) 37.1990 
2018-02-25 14:39:42,553 [INFO] IRT.run_mlp: Epoch 32 starts! 
2018-02-25 14:39:46,739 [INFO] IRT.run_mlp: epoch 32 training loss (over all batches) 37.1214 
2018-02-25 14:39:46,740 [INFO] IRT.run_mlp: Epoch 33 starts! 
2018-02-25 14:39:50,928 [INFO] IRT.run_mlp: epoch 33 training loss (over all batches) 37.1914 
2018-02-25 14:39:50,929 [INFO] IRT.run_mlp: Epoch 34 starts! 
2018-02-25 14:39:55,074 [INFO] IRT.run_mlp: epoch 34 training loss (over all batches) 36.3847 
2018-02-25 14:39:55,075 [INFO] IRT.run_mlp: Epoch 35 starts! 
2018-02-25 14:39:59,270 [INFO] IRT.run_mlp: epoch 35 training loss (over all batches) 36.2217 
2018-02-25 14:39:59,271 [INFO] IRT.run_mlp: Epoch 36 starts! 
2018-02-25 14:40:03,429 [INFO] IRT.run_mlp: epoch 36 training loss (over all batches) 36.1388 
2018-02-25 14:40:03,430 [INFO] IRT.run_mlp: Epoch 37 starts! 
2018-02-25 14:40:07,581 [INFO] IRT.run_mlp: epoch 37 training loss (over all batches) 35.6046 
2018-02-25 14:40:07,582 [INFO] IRT.run_mlp: Epoch 38 starts! 
2018-02-25 14:40:11,702 [INFO] IRT.run_mlp: epoch 38 training loss (over all batches) 35.0197 
2018-02-25 14:40:11,702 [INFO] IRT.run_mlp: Epoch 39 starts! 
2018-02-25 14:40:15,888 [INFO] IRT.run_mlp: epoch 39 training loss (over all batches) 35.7037 
2018-02-25 14:40:15,889 [INFO] IRT.run_mlp: Epoch 40 starts! 
2018-02-25 14:40:20,050 [INFO] IRT.run_mlp: epoch 40 training loss (over all batches) 35.0290 
2018-02-25 14:40:20,059 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:40:20,066 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7132 auc 0.7398 
2018-02-25 14:40:20,066 [INFO] IRT.run_mlp: Epoch 41 starts! 
2018-02-25 14:40:24,134 [INFO] IRT.run_mlp: epoch 41 training loss (over all batches) 34.8466 
2018-02-25 14:40:24,135 [INFO] IRT.run_mlp: Epoch 42 starts! 
2018-02-25 14:40:28,290 [INFO] IRT.run_mlp: epoch 42 training loss (over all batches) 34.3567 
2018-02-25 14:40:28,291 [INFO] IRT.run_mlp: Epoch 43 starts! 
2018-02-25 14:40:32,446 [INFO] IRT.run_mlp: epoch 43 training loss (over all batches) 34.6911 
2018-02-25 14:40:32,447 [INFO] IRT.run_mlp: Epoch 44 starts! 
2018-02-25 14:40:36,585 [INFO] IRT.run_mlp: epoch 44 training loss (over all batches) 34.1268 
2018-02-25 14:40:36,586 [INFO] IRT.run_mlp: Epoch 45 starts! 
2018-02-25 14:40:40,741 [INFO] IRT.run_mlp: epoch 45 training loss (over all batches) 34.0606 
2018-02-25 14:40:40,742 [INFO] IRT.run_mlp: Epoch 46 starts! 
2018-02-25 14:40:44,925 [INFO] IRT.run_mlp: epoch 46 training loss (over all batches) 33.7127 
2018-02-25 14:40:44,926 [INFO] IRT.run_mlp: Epoch 47 starts! 
2018-02-25 14:40:49,086 [INFO] IRT.run_mlp: epoch 47 training loss (over all batches) 33.9302 
2018-02-25 14:40:49,087 [INFO] IRT.run_mlp: Epoch 48 starts! 
2018-02-25 14:40:53,281 [INFO] IRT.run_mlp: epoch 48 training loss (over all batches) 34.2342 
2018-02-25 14:40:53,282 [INFO] IRT.run_mlp: Epoch 49 starts! 
2018-02-25 14:40:57,460 [INFO] IRT.run_mlp: epoch 49 training loss (over all batches) 33.6869 
2018-02-25 14:40:57,471 [INFO] IRT.run_mlp: Fold 4: Num Interactions: 69348; Test Accuracy: 0.71323; Test AUC: 0.73975
2018-02-25 14:40:57,511 [INFO] IRT.run_mlp: this fold has 69348 interactions and students 3731
2018-02-25 14:40:57,511 [INFO] IRT.run_mlp: Beginning fold 5
2018-02-25 14:40:57,511 [INFO] IRT.run_mlp: Training RNN, fold 5, train length 277392, test length 69348
2018-02-25 14:40:57,511 [INFO] IRT.run_mlp: num_questions=26684? 26684 num_users=4097? 4097
2018-02-25 14:40:57,610 [INFO] IRT.run_mlp: Building model: embedding size 150 hidden dimension 200
2018-02-25 14:40:57,859 [INFO] IRT.run_mlp: NCF input_dim=2*emb_size+1(timestamp) 301 hidden_num 200 output_dim 2
2018-02-25 14:40:57,859 [INFO] IRT.run_mlp: Model optimizer first learning rate is 0.001
2018-02-25 14:40:57,862 [INFO] IRT.run_mlp: Cuda detected, using cuda
2018-02-25 14:40:57,862 [INFO] IRT.run_mlp: Number of iterations for this fold 50
2018-02-25 14:40:57,862 [INFO] IRT.run_mlp: Epoch 0 starts! 
2018-02-25 14:41:02,025 [INFO] IRT.run_mlp: epoch 0 training loss (over all batches) 461.2547 
2018-02-25 14:41:02,026 [INFO] IRT.run_mlp: Epoch 1 starts! 
2018-02-25 14:41:06,211 [INFO] IRT.run_mlp: epoch 1 training loss (over all batches) 396.6704 
2018-02-25 14:41:06,212 [INFO] IRT.run_mlp: Epoch 2 starts! 
2018-02-25 14:41:10,382 [INFO] IRT.run_mlp: epoch 2 training loss (over all batches) 355.9652 
2018-02-25 14:41:10,383 [INFO] IRT.run_mlp: Epoch 3 starts! 
2018-02-25 14:41:14,569 [INFO] IRT.run_mlp: epoch 3 training loss (over all batches) 326.5139 
2018-02-25 14:41:14,570 [INFO] IRT.run_mlp: Epoch 4 starts! 
2018-02-25 14:41:18,720 [INFO] IRT.run_mlp: epoch 4 training loss (over all batches) 294.5765 
2018-02-25 14:41:18,721 [INFO] IRT.run_mlp: Epoch 5 starts! 
2018-02-25 14:41:22,918 [INFO] IRT.run_mlp: epoch 5 training loss (over all batches) 256.5662 
2018-02-25 14:41:22,919 [INFO] IRT.run_mlp: Epoch 6 starts! 
2018-02-25 14:41:27,075 [INFO] IRT.run_mlp: epoch 6 training loss (over all batches) 215.1983 
2018-02-25 14:41:27,076 [INFO] IRT.run_mlp: Epoch 7 starts! 
2018-02-25 14:41:31,268 [INFO] IRT.run_mlp: epoch 7 training loss (over all batches) 176.3842 
2018-02-25 14:41:31,269 [INFO] IRT.run_mlp: Epoch 8 starts! 
2018-02-25 14:41:35,463 [INFO] IRT.run_mlp: epoch 8 training loss (over all batches) 142.1833 
2018-02-25 14:41:35,464 [INFO] IRT.run_mlp: Epoch 9 starts! 
2018-02-25 14:41:39,570 [INFO] IRT.run_mlp: epoch 9 training loss (over all batches) 116.0157 
2018-02-25 14:41:39,571 [INFO] IRT.run_mlp: Epoch 10 starts! 
2018-02-25 14:41:43,736 [INFO] IRT.run_mlp: epoch 10 training loss (over all batches) 96.0459 
2018-02-25 14:41:43,745 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:41:43,753 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7055 auc 0.7420 
2018-02-25 14:41:43,753 [INFO] IRT.run_mlp: Epoch 11 starts! 
2018-02-25 14:41:47,876 [INFO] IRT.run_mlp: epoch 11 training loss (over all batches) 81.8853 
2018-02-25 14:41:47,877 [INFO] IRT.run_mlp: Epoch 12 starts! 
2018-02-25 14:41:52,028 [INFO] IRT.run_mlp: epoch 12 training loss (over all batches) 70.8579 
2018-02-25 14:41:52,029 [INFO] IRT.run_mlp: Epoch 13 starts! 
2018-02-25 14:41:56,142 [INFO] IRT.run_mlp: epoch 13 training loss (over all batches) 64.2382 
2018-02-25 14:41:56,143 [INFO] IRT.run_mlp: Epoch 14 starts! 
2018-02-25 14:42:00,328 [INFO] IRT.run_mlp: epoch 14 training loss (over all batches) 58.8621 
2018-02-25 14:42:00,329 [INFO] IRT.run_mlp: Epoch 15 starts! 
2018-02-25 14:42:04,487 [INFO] IRT.run_mlp: epoch 15 training loss (over all batches) 54.2180 
2018-02-25 14:42:04,488 [INFO] IRT.run_mlp: Epoch 16 starts! 
2018-02-25 14:42:08,687 [INFO] IRT.run_mlp: epoch 16 training loss (over all batches) 51.2881 
2018-02-25 14:42:08,688 [INFO] IRT.run_mlp: Epoch 17 starts! 
2018-02-25 14:42:12,866 [INFO] IRT.run_mlp: epoch 17 training loss (over all batches) 48.6680 
2018-02-25 14:42:12,867 [INFO] IRT.run_mlp: Epoch 18 starts! 
2018-02-25 14:42:17,018 [INFO] IRT.run_mlp: epoch 18 training loss (over all batches) 46.9734 
2018-02-25 14:42:17,019 [INFO] IRT.run_mlp: Epoch 19 starts! 
2018-02-25 14:42:21,211 [INFO] IRT.run_mlp: epoch 19 training loss (over all batches) 45.6420 
2018-02-25 14:42:21,212 [INFO] IRT.run_mlp: Epoch 20 starts! 
2018-02-25 14:42:25,360 [INFO] IRT.run_mlp: epoch 20 training loss (over all batches) 43.8942 
2018-02-25 14:42:25,369 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:42:25,376 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7117 auc 0.7468 
2018-02-25 14:42:25,376 [INFO] IRT.run_mlp: Epoch 21 starts! 
2018-02-25 14:42:29,539 [INFO] IRT.run_mlp: epoch 21 training loss (over all batches) 42.6423 
2018-02-25 14:42:29,540 [INFO] IRT.run_mlp: Epoch 22 starts! 
2018-02-25 14:42:33,668 [INFO] IRT.run_mlp: epoch 22 training loss (over all batches) 41.8754 
2018-02-25 14:42:33,669 [INFO] IRT.run_mlp: Epoch 23 starts! 
2018-02-25 14:42:37,840 [INFO] IRT.run_mlp: epoch 23 training loss (over all batches) 41.4976 
2018-02-25 14:42:37,841 [INFO] IRT.run_mlp: Epoch 24 starts! 
2018-02-25 14:42:42,051 [INFO] IRT.run_mlp: epoch 24 training loss (over all batches) 40.2350 
2018-02-25 14:42:42,052 [INFO] IRT.run_mlp: Epoch 25 starts! 
2018-02-25 14:42:46,207 [INFO] IRT.run_mlp: epoch 25 training loss (over all batches) 39.2214 
2018-02-25 14:42:46,208 [INFO] IRT.run_mlp: Epoch 26 starts! 
2018-02-25 14:42:50,404 [INFO] IRT.run_mlp: epoch 26 training loss (over all batches) 38.8909 
2018-02-25 14:42:50,405 [INFO] IRT.run_mlp: Epoch 27 starts! 
2018-02-25 14:42:54,580 [INFO] IRT.run_mlp: epoch 27 training loss (over all batches) 38.2977 
2018-02-25 14:42:54,581 [INFO] IRT.run_mlp: Epoch 28 starts! 
2018-02-25 14:42:58,767 [INFO] IRT.run_mlp: epoch 28 training loss (over all batches) 37.5493 
2018-02-25 14:42:58,768 [INFO] IRT.run_mlp: Epoch 29 starts! 
2018-02-25 14:43:02,928 [INFO] IRT.run_mlp: epoch 29 training loss (over all batches) 36.9235 
2018-02-25 14:43:02,929 [INFO] IRT.run_mlp: Epoch 30 starts! 
2018-02-25 14:43:07,133 [INFO] IRT.run_mlp: epoch 30 training loss (over all batches) 36.6841 
2018-02-25 14:43:07,142 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:43:07,149 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7138 auc 0.7455 
2018-02-25 14:43:07,149 [INFO] IRT.run_mlp: Epoch 31 starts! 
2018-02-25 14:43:11,318 [INFO] IRT.run_mlp: epoch 31 training loss (over all batches) 37.0005 
2018-02-25 14:43:11,319 [INFO] IRT.run_mlp: Epoch 32 starts! 
2018-02-25 14:43:15,519 [INFO] IRT.run_mlp: epoch 32 training loss (over all batches) 36.6522 
2018-02-25 14:43:15,520 [INFO] IRT.run_mlp: Epoch 33 starts! 
2018-02-25 14:43:19,729 [INFO] IRT.run_mlp: epoch 33 training loss (over all batches) 35.8010 
2018-02-25 14:43:19,730 [INFO] IRT.run_mlp: Epoch 34 starts! 
2018-02-25 14:43:23,910 [INFO] IRT.run_mlp: epoch 34 training loss (over all batches) 35.8227 
2018-02-25 14:43:23,911 [INFO] IRT.run_mlp: Epoch 35 starts! 
2018-02-25 14:43:28,106 [INFO] IRT.run_mlp: epoch 35 training loss (over all batches) 35.6804 
2018-02-25 14:43:28,107 [INFO] IRT.run_mlp: Epoch 36 starts! 
2018-02-25 14:43:32,258 [INFO] IRT.run_mlp: epoch 36 training loss (over all batches) 35.5995 
2018-02-25 14:43:32,259 [INFO] IRT.run_mlp: Epoch 37 starts! 
2018-02-25 14:43:36,470 [INFO] IRT.run_mlp: epoch 37 training loss (over all batches) 35.2915 
2018-02-25 14:43:36,471 [INFO] IRT.run_mlp: Epoch 38 starts! 
2018-02-25 14:43:40,642 [INFO] IRT.run_mlp: epoch 38 training loss (over all batches) 34.8752 
2018-02-25 14:43:40,643 [INFO] IRT.run_mlp: Epoch 39 starts! 
2018-02-25 14:43:44,846 [INFO] IRT.run_mlp: epoch 39 training loss (over all batches) 34.6323 
2018-02-25 14:43:44,847 [INFO] IRT.run_mlp: Epoch 40 starts! 
2018-02-25 14:43:49,056 [INFO] IRT.run_mlp: epoch 40 training loss (over all batches) 34.5969 
2018-02-25 14:43:49,065 [INFO] IRT.run_mlp: Prediction positive 1.0000 
2018-02-25 14:43:49,071 [INFO] IRT.run_mlp: testing every 10 accuracy 0.7202 auc 0.7442 
2018-02-25 14:43:49,071 [INFO] IRT.run_mlp: Epoch 41 starts! 
2018-02-25 14:43:53,238 [INFO] IRT.run_mlp: epoch 41 training loss (over all batches) 34.3889 
2018-02-25 14:43:53,239 [INFO] IRT.run_mlp: Epoch 42 starts! 
2018-02-25 14:43:57,422 [INFO] IRT.run_mlp: epoch 42 training loss (over all batches) 34.1889 
2018-02-25 14:43:57,423 [INFO] IRT.run_mlp: Epoch 43 starts! 
2018-02-25 14:44:01,582 [INFO] IRT.run_mlp: epoch 43 training loss (over all batches) 33.8620 
2018-02-25 14:44:01,583 [INFO] IRT.run_mlp: Epoch 44 starts! 
2018-02-25 14:44:05,758 [INFO] IRT.run_mlp: epoch 44 training loss (over all batches) 34.0388 
2018-02-25 14:44:05,759 [INFO] IRT.run_mlp: Epoch 45 starts! 
2018-02-25 14:44:09,903 [INFO] IRT.run_mlp: epoch 45 training loss (over all batches) 33.4615 
2018-02-25 14:44:09,904 [INFO] IRT.run_mlp: Epoch 46 starts! 
2018-02-25 14:44:14,083 [INFO] IRT.run_mlp: epoch 46 training loss (over all batches) 33.4808 
2018-02-25 14:44:14,084 [INFO] IRT.run_mlp: Epoch 47 starts! 
2018-02-25 14:44:18,207 [INFO] IRT.run_mlp: epoch 47 training loss (over all batches) 33.4061 
2018-02-25 14:44:18,208 [INFO] IRT.run_mlp: Epoch 48 starts! 
2018-02-25 14:44:22,368 [INFO] IRT.run_mlp: epoch 48 training loss (over all batches) 33.2539 
2018-02-25 14:44:22,369 [INFO] IRT.run_mlp: Epoch 49 starts! 
2018-02-25 14:44:26,568 [INFO] IRT.run_mlp: epoch 49 training loss (over all batches) 33.4485 
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 5: Num Interactions: 69348; Test Accuracy: 0.72019; Test AUC: 0.74418
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Completed all 5 folds
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 1 Acc: 0.71539 AUC: 0.74085
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 2 Acc: 0.71321 AUC: 0.74225
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 3 Acc: 0.72132 AUC: 0.74853
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 4 Acc: 0.71323 AUC: 0.73975
2018-02-25 14:44:26,580 [INFO] IRT.run_mlp: Fold 5 Acc: 0.72019 AUC: 0.74418
2018-02-25 14:44:26,581 [INFO] IRT.run_mlp: Overall 5 Acc: 0.71667 AUC: 0.74311
